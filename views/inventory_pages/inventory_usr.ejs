<div class="
    bg-blue-400
    shadow-md
    w-full
    px-10
    py-2
    flex
    justify-start
    items-center
  ">
  <a href="/inventory">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="#fff">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
    </svg>
</a>
<!-- TODO: Name here dynamically -->
    <div class="text-4xl text-white mx-8 my-4">Inventory</div>
</div>


<h2 class="font-bold w-4/5 mx-auto mt-12 pb-2 border-b border-gray-200 mx-auto text-xl">Upload Notes:</h2>

<div class="w-4/5 mx-auto flex">
  <div class="w-2/5 mx-2 my-4 bg-white p-5 card rounded-3xl shadow-lg">
    <form action="/api/upload-file" method="POST" enctype="multipart/form-data">
      <input type="hidden" value="<%= curr_info.subject %>" name="subject" class="subject">
      <input type="hidden" value="usr" name="type" class="type">
  
      <div
        class="
          border
          focus-within:border-blue-500 focus-within:text-blue-500
          transition-all
          duration-500
          rounded
          p-1
          my-4
        "
      >
        <div class="-mt-4 absolute tracking-wider px-1 uppercase text-xs">
          <p>
            <label for="book_name" class="bg-white font-bold px-1"
              >Name of Book:</label
            >
          </p>
        </div>
        <p>
          <input
            id="book_name"
            autocomplete="off"
            tabindex="0"
            type="text"
            required
            class="py-1 px-1 text-gray-900 outline-none block h-full w-full"
          />
        </p>
      </div>

      <div class="flex my-2">
        <div
          class="
            border
            focus-within:border-blue-500 focus-within:text-blue-500
            transition-all
            duration-500
            rounded
            p-1
            mr-4
            w-full
          "
        >
          <div class="-mt-4 absolute tracking-wider px-1 uppercase text-xs">
            <p>
              <label for="author_name" class="bg-white font-bold px-1"
                >Author Name:</label
              >
            </p>
          </div>
          <p>
            <input
              id="author_name"
              required
              name="num_questions"
              autocomplete="false"
              tabindex="0"
              class="py-1 px-1 text-gray-900 outline-none block h-full w-full"
            />
          </p>
        </div>
      </div>

      <div
        class="
          border
          focus-within:border-blue-500 focus-within:text-blue-500
          transition-all
          duration-500
          rounded
          p-1
          my-4
        "
      >
      <input type="file" name="pdf" id="file_input" /> <br />

      </div>

      <div class="w-100 flex flex-wrap">
        <div></div>
        <div class="
        rounded-lg
        ml-auto
        font-bold
        text-white
        px-3
        py-1
        bg-blue-400
        hover:shadow-inner
        hover:bg-blue-700
        transition-all
        duration-700
      " id="submit-button">
        Upload >>>>
    </div> 
       
          
      </input>
      </div>
    </form>
  </div>

  
</div>

<div class="w-full">
    <h2 class="font-bold mt-12 pb-2 border-b border-gray-200 w-4/5 mx-auto">Notes:</h2>

<div class="mt-8 grid grid-cols-3 w-4/5 mx-auto">
  <% for (var i=0; i < curr_notes.length; i++) {%>

    <div class="card rounded-3xl shadow-md border-t-4 border-blue-300 mx-8 my-4">
      <div class="m-4">
        
        <span class="font-bold"><%= curr_notes[i].book_name %></span>
  
        <div class="w-100 flex">
          <div>
            <span class="block text-gray-500 text-sm">By : <%= curr_notes[i].author_name %> </span>
            <span class="block text-gray-500 text-sm">File : <%= curr_notes[i].file_name %> </span>
          </div>
          
          <a
            href="/notes/view?type=org&file_name=<%= curr_notes[i].file_name %>&subject=<%= curr_info.subject %>"
            class="ml-auto"
            ><span class="text-blue-600">Click to view >>></span></a
          >
        </div>
      </div>
    </div>
  
    <% } %>

</div>


</div>

<script>
  const submit_button = document.getElementById("submit-button");

  submit_button.onclick = async function () {
    const book_name = document.getElementById("book_name");
    const author_name = document.getElementById("author_time");
    const selectedFile = document.getElementById('file_input').files[0];

    var paperBuffer = await selectedFile.arrayBuffer();
    paperBuffer = new Uint8Array(paperBuffer);

    const body = new FormData();
    body.append(selectedFile.name, new Blob([paperBuffer]), selectedFile.name);
    body.append("subject","dsa")
    body.append("type","usr")
    body.append("user_name","SampleUser2")
    body.append("organization", "ABVIIITM")

    // TODO : Do this dynamically
    body.append("book_name",book_name)
    body.append("author_name", author_name)
    body.append("file_name",selectedFile.name)

    fetch(
        "https://localhost:5000/upload-file",
        {
            method: "POST",
            body,
        }
    );
  }
  
</script>